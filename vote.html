
<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>CITY LINKED | Weekly Vote</title>
<style>
    @import url('https://fonts.googleapis.com/css2?family=Gruppo&display=swap');
    body {
      font-family: 'Gruppo', sans-serif;
      background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('images/bg.jpg') no-repeat center center fixed;
      background-size: cover;
      color: #ffffff;
      text-align: center;
      padding: 40px 20px;
    }
    .vote-title {
      font-size: 32px;
      margin-bottom: 10px;
    }
    .vote-subtitle {
      font-size: 18px;
      color: #dddddd;
      margin-bottom: 30px;
    }
    .city-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
      margin-bottom: 30px;
    }
    .city-button {
      background: white;
      border: 2px solid #00B4DB;
      border-radius: 14px;
      padding: 18px 24px;
      font-size: 18px;
      font-weight: bold;
      color: #000000;
      cursor: pointer;
      transition: transform 0.15s, background-color 0.3s;
      min-width: 160px;
    }
    .city-button:hover {
      background-color: #e6faff;
      transform: scale(1.04);
    }
    .thank-you {
      font-size: 20px;
      color: #ffffff;
      margin-top: 20px;
    }
    .admin-buttons {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 12px;
      max-width: 700px;
      margin: 140px auto 0;
    }
    .admin-button {
      background-color: #00B4DB;
      border: none;
      border-radius: 12px;
      padding: 14px;
      font-size: 14px;
      font-weight: bold;
      color: #fff;
      cursor: pointer;
      transition: background-color 0.3s, transform 0.2s;
    }
    .admin-button:hover {
      background-color: #0093af;
      transform: scale(1.04);
    }
    .admin-button.active {
      background-color: #ffaa00;
      color: #000;
    }
  </style>
</head>
<body><div class="vote-title">üåç Unlock The Next City</div><div class="vote-subtitle">Tap your favorite ‚Äî and help unlock a new city this Friday.</div>
<div class="city-container" id="city-buttons"></div>
<div id="thank-you" style="display:none;">‚úÖ Thanks for voting!</div>
<script>
    const adminKey = "710887";
    const isAdmin = new URLSearchParams(window.location.search).get("admin") === adminKey;
    const cities = ["Amsterdam", "Lisbon", "Bangkok", "Rome", "Buenos Aires"];
    const cityContainer = document.getElementById("city-buttons");
    const thankYou = document.getElementById("thank-you");

    const hasVoted = localStorage.getItem("votedThisWeek");

    if (hasVoted && !isAdmin) {
      cityContainer.innerHTML = "";
      thankYou.innerText = "‚úÖ You've already voted this week. Come back next Monday!";
      thankYou.style.display = "block";
    } else {
      cities.forEach(city => {
        const btn = document.createElement("button");
        btn.className = "city-button";
        btn.textContent = city;
        btn.onclick = () => handleVote(city);
        cityContainer.appendChild(btn);
      });
    }

    function handleVote(city) {
      cityContainer.innerHTML = "";
      thankYou.innerText = "‚úÖ Thanks for voting!";
      thankYou.style.display = "block";
      localStorage.setItem("votedThisWeek", "true");

      if (isAdmin) {
        // Admin creates vote_request.json on GitHub (handled by backend Action)
        fetch("https://CITY-LINKED.github.io/city-linked-data/vote_request.json", {
          method: "PUT", // note: this won't work directly in browser; GitHub Actions watches the file via commits
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            timestamp: new Date().toISOString(),
            user: "admin_710887",
            city: city
          })
        }).then(() => {
          console.log("Admin vote registered for:", city);
        }).catch(() => {
          console.log("Simulated admin vote.");
        });
      }
    }
  </script>
<div class="admin-buttons" id="admin-section" style="display: none;">
<button class="admin-button">‚ûï Boost Mode (100)</button>
<button class="admin-button">üèÜ Announce Winner</button>
<button class="admin-button">üîÑ Generate 5 Cities</button>
<button class="admin-button">üßπ Reset All</button>
</div></body>
</html>
